Examining BusController code: - Found 2 endpoints: /busesAll (GET) and /busesAdd/{travelId}/{authKey} (POST). - @CrossOrigin(origins='*') allows requests from any origin. 2.Analyzing Bus model: - Contains sensitive fields like busId, busNo, capacity. - References Travel entity through ManyToOne relationship. 3.Analyzing Travel model: - Contains sensitive data (agent details, address, contact). - Has OneToMany relationship with Bus. 4.Looking at service layer: - BusService interface shows methods but need implementation to verify auth checks. 5.Evaluating IDOR risks: - /busesAll exposes all buses without auth. - /busesAdd uses travelId path parameter that could be manipulated. - Need BusServiceImpl to confirm if auth checks exist at service layer. 6.Requesting BusServiceImpl for complete analysis of authorization controls.",    "analysis": "The BusController exposes critical IDOR vulnerabilities through both its endpoints. The /busesAll endpoint provides unauthenticated access to all bus records across all travel agencies, exposing sensitive business data including bus details, travel agency information, and agent contact details. The /busesAdd/{travelId}/{authKey} endpoint accepts a travelId parameter that could be manipulated to add buses to unauthorized travel agencies. While an authKey parameter exists, without seeing the BusServiceImpl implementation, we cannot verify if proper authorization checks are performed. The @CrossOrigin annotation allowing requests from any origin amplifies the attack surface. The Bus and Travel entity relationships allow an attacker to access related sensitive data through these endpoints.",    "poc": "IDOR Exploit for /busesAll:\n1. Send GET request to /busesAll\n2. Receive complete list of buses with sensitive details without authentication\n\nIDOR Exploit for /busesAdd:\n1. Enumerate valid travelIds through /busesAll response\n2. Send POST to /busesAdd/[valid_travel_id]/[guessed_auth_key] with bus payload\n3. Attempt to add bus to unauthorized travel agency",    "confidence_score": 7,    "vulnerability_types": ["IDOR"],    "context_code": [{        "name": "BusServiceImpl",        "reason": "Need to verify if proper authorization checks exist in the service layer implementation",        "code_line": "@Autowired private BusService bService;"    }]}